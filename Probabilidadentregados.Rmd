---
title: "Libro de Estadística y Probabilidad"
author: "Gerardo Hernandez Mondragon"
date: "18-003-1784"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Sesión 9

1. X distribución normal con media = 2 y DesvEst = 1/3
 a) P[X>3]

```{r }
x0 <- 3
mu <- 2   
desvest <- 1/3
z0 <- (x0-mu)/desvest
print(z0)
probabilidad <- pnorm(z0,0,1)
print(probabilidad)
probbuscada  <- 1-probabilidad
print(probbuscada)
```

 b) P[2<X<3]

```{r }
mu <- 2   
desvest <- 1/3
x1 <- 2   
z1 <- (x1-mu)/desvest
print(z1)
p1 <- pnorm(z1,0,1)
print(p1)
x2 <- 3
z2 <- (x2-mu)/desvest
print(z2)
p2 <- pnorm(z2,0,1)
print(p2)
probbuscada <- p2-p1
print(probbuscada)
```

 c) P[X<0]

```{r }
x3 <- 0
mu <- 2
desvest <- 1/3
z3 <- (x3-mu)/desvest
print(z3)
probabilidad <- pnorm(z3,0,1)
print(probabilidad)
```

 d) P[-1<X<1]
 
```{r }
mu <- 2
desvest <- 1/3
x4 <- -1   
z4 <- (x4-mu)/desvest
print(z4)
p4 <- pnorm(z4,0,1)
print(p4)
x5 <- 1
z5 <- (x5-mu)/desvest
print(z5)
p5 <- pnorm(z5,0,1)
print(p5)
probbuscada <- p5-p4
print(probbuscada)
```

 e) Encontrar x0 tal que P[X>x0]= 0.45
 P[X>x*]= p*, entonces buscamos en tablas el valor x*, tal que 
 P[X<x*] = q*= 1-p*, esto se hace con la funcion qnorm(q*,0,1)
 
```{r }
pestrella <- 0.45
qestrella = 1-pestrella
print(qestrella)
zestrella <- qnorm(qestrella,0,1)
print(zestrella)
```

 Corroboramos 
 
```{r }
pnorm(zestrella,0,1) # si es la respuesta correcta!!!!
mu <- 2
desvest <- 1/3
xestrella <- mu+desvest*zestrella
print(xestrella)
pnorm(xestrella,2,1/3)
```

 Encontrar x* tal que P[X<x*]= alfa
 
 i)   alfa = 0.5;   ii) alfa = 0.75;  iii) alfa = 0.8;
 iv)  alfa = 0.85;   v) alfa = 0.9;    vi) alfa = 0.95
 vii) alfa = 0.99
 
```{r } 
 mu <- 2
desvest <- 1/3
``` 

 i)   alfa = 0.5
 
```{r } 
alfa1 <- 0.5;
zest1 <- qnorm(alfa1,0,1)
print(zest1)
xest1 <- mu+desvest*zest1
print(xest1)
```

 ii) alfa = 0.75
 
```{r } 
alfa2 <- 0.75;
zest2 <- qnorm(alfa2,0,1)
print(zest2)
xest2 <- mu+desvest*zest2
print(xest2)
```

 iii) alfa = 0.8
 
```{r } 
alfa3 <- 0.8;
zest3 <- qnorm(alfa3,0,1)
print(zest3)
xest3 <- mu+desvest*zest3
print(xest3)
```

iv)  alfa = 0.85

```{r } 
alfa4 <- 0.85;
zest4 <- qnorm(alfa4,0,1)
print(zest4)
xest4 <- mu+desvest*zest4 
print(xest4)
```

 v) alfa = 0.9

```{r } 
alfa5 <- 0.9;
zest5 <- qnorm(alfa5,0,1)
print(zest5)
xest5 <- mu+desvest*zest5
print(xest5)
```

 vi) alfa = 0.95

```{r } 
alfa6 <- 0.95
zest6 <- qnorm(alfa6,0,1) 
print(zest6)
xest6 <- mu+desvest*zest6
print(xest6)
```

 vii) alfa = 0.99
 
```{r } 
alfa7 <- 0.99;
zest7 <- qnorm(alfa7,0,1)
print(zest7)
xest7 <- mu+desvest*zest7
print(xest7)
```

Mostramos resultados

```{r } 
Resultados <- matrix(0,7,3)
Resultados[,1] <- c(alfa1, alfa2, alfa3, alfa4, alfa5, alfa6, alfa7)
Resultados[,2] <- c(zest1,zest2,zest3,zest4,zest5,zest6,zest7)
print(Resultados)
Resultados[,3] <- c(xest1,xest2,xest3,xest4,xest5,xest6,xest7)
print(Resultados)
colnames(Resultados) <- c('Confianza','z*','x*')
print(Resultados)
rownames(Resultados) <- c(1,2,3,4,5,6,7)
print(Resultados)
```

Sesión 10

Encontrar x* tal que P[X<x*]= alfa
 
 i)   alfa = 0.75;   ii) alfa = 0.875;  iii) alfa = 0.9;
 iv)  alfa = 0.925;   v) alfa = 0.95;    vi) alfa = 0.975
 vii) alfa = 0.995


 i)   alfa = 0.75

```{r } 
alfa1 <- 0.75;
zest1 <- qnorm(alfa1,0,1)
print(zest1)
xest1 <- mu+desvest*zest1
print(xest1)
```

ii)   alfa = 0.875

```{r } 
alfa2 <- 0.875;
zest2 <- qnorm(alfa2,0,1)
print(zest2)
xest2 <- mu+desvest*zest2
print(xest2)
```

iii) alfa = 0.9

```{r } 
alfa3 <- 0.9;
zest3 <- qnorm(alfa3,0,1)
print(zest3)
xest3 <- mu+desvest*zest3
print(xest3)
```

iv)  alfa = 0.925

```{r } 
alfa4 <- 0.925;
zest4 <- qnorm(alfa4,0,1)
print(zest4)
xest4 <- mu+desvest*zest4
print(xest4)
```

v) alfa = 0.95

```{r } 
alfa5 <- 0.95;
zest5 <- qnorm(alfa5,0,1)
print(zest5)
xest5 <- mu+desvest*zest5
print(xest5)
```

vi) alfa = 0.975

```{r } 
alfa6 <- 0.975;
zest6 <- qnorm(alfa6,0,1)
print(zest6)
xest6 <- mu+desvest*zest6
print(xest6)
```

vii) alfa = 0.995

```{r } 
alfa7 <- 0.995;
zest7 <- qnorm(alfa7,0,1)
print(zest7)
xest7 <- mu+desvest*zest7
print(xest7)
```

Mostramos el resultado

```{r } 
Resultados <- matrix(0,7,5)
Resultados[,1] <- c(alfa1, alfa2, alfa3, alfa4, alfa5, alfa6, alfa7)
print(Resultados)
Resultados[,3] <- c(zest1,zest2,zest3,zest4,zest5,zest6,zest7)
print(Resultados)
Resultados[,2] <- -Resultados[,3]
Resultados[,5] <- c(xest1,xest2,xest3,xest4,xest5,xest6,xest7)
print(Resultados)
Resultados[,4] <- -Resultados[,5]
colnames(Resultados) <- c('Confianza','*-z*','z*','-x*','x*')
print(Resultados)
rownames(Resultados) <- c(1,2,3,4,5,6,7)
print(Resultados)
```

Imprimimos los valores resultantes de las anteriores operaciones

```{r } 
indices <- c(1,3)
renglones <- c(5,6,7)
ValoresZ <- Resultados[renglones,indices]
print(ValoresZ)
rownames(ValoresZ) <- c('90%','95%','99%')
print(ValoresZ)
```

Mini rutina para calcular intervalos de confianza para una media y para muestras grandes

 Ejercicio 1
 
tamaño de la muestra (n): 10 
Media muestral ( xˉ): 170 cm
Desviación estándar muestral ( s): 8 cm
Nivel de confianza:  95

```{r } 
DesvEst <- 8
n <- 100
xbarra <- 170
alpha <- 90
Zalpha1 <- 1.64
alpha <- 95
Zalpha2 <- 1.96
alpha <- 99
Zalpha3 <- 2.57
mu1 <- xbarra - Zalpha2*(DesvEst/sqrt(n))
print(mu1)
mu2 <- xbarra + Zalpha2*(DesvEst/sqrt(n))
print(mu2)
Intervalo <- paste0("mu ∈  ","(",mu1,",",mu2,")")
print(Intervalo)
```

Ejercicio 2

Intervalo de confianza del   95 para la media de las alturas de una población de 50 estudiantes universitarios:
 Media muestral : 400 cm
 Desviación estándar muestral s: 10 cm
 

```{r }
DesvEst <- 10
n <- 50
xbarra <- 400
alpha <- 90; Zalpha1 <- 1.64
alpha <- 95; Zalpha2 <- 1.96
alpha <- 99; Zalpha3 <- 2.57

mu1 <- xbarra - Zalpha1*(DesvEst/sqrt(n))
print(mu1)
mu2 <- xbarra + Zalpha1*(DesvEst/sqrt(n))
print(mu2)

Intervalo <- paste0("mu ∈  ","(",mu1,",",mu2,")") 
print(Intervalo)


Intervalo <- paste0("mu ∈  ","(",round(mu1,2),",",round(mu2,2),")")
print(Intervalo)
```

 ejercicio 3
 
 Intervalo de confianza del   95 para la media de las alturas de una población   de 2000  estudiantes universitarios:
 Media muestral : 170 cm
 Desviación estándar muestral s: 10 cm

```{r } 
DesvEst <- 10
n <- 2000
xbarra <- 170
alpha <- 90; Zalpha1 <- 1.64
alpha <- 95; Zalpha2 <- 1.96
alpha <- 99; Zalpha3 <- 2.57

mu1 <- xbarra - Zalpha2*(DesvEst/sqrt(n))
print(mu1)
mu2 <- xbarra + Zalpha2*(DesvEst/sqrt(n))
print(mu2)

Intervalo <- paste0("mu ∈  ","(",round(mu1,2),",",round(mu2,2),")") 
print(Intervalo)
```

Sesión 11

Ejemplo 1:

tamaño de la muestra (n): 10 
Media muestral ( xˉ): 170 cm
Desviación estándar muestral ( s): 8 cm
Nivel de confianza:  95

```{r } 
n <- 10
xbarra <- 170
DesvEst <- 8
gl <- n-1
nc <- 0.975

Talpha2 <- round(qt(nc, gl),4)
mu1 <- xbarra - Talpha2*(DesvEst/sqrt(n)); 
mu2 <- xbarra + Talpha2*(DesvEst/sqrt(n)); 
Intervalo <- paste0("mu ∈  ","(",round(mu1,2),",",
                    round(mu2,2),")"); 
print(Intervalo)
```

Ejemplo 2:

tamaño de la muestra (n): 10
Media muestral ( xˉ): 170 cm
Desviación estándar muestral ( s): 8 cm
Nivel de confianza:  95

```{r } 
n <- 15
xbarra <- 3.5
DesvEst <- 0.5
gl <- n-1
nc <- 0.95

Talpha2 <- round(qt(nc, gl),4)
mu1 <- xbarra - Talpha2*(DesvEst/sqrt(n)); 
mu2 <- xbarra + Talpha2*(DesvEst/sqrt(n)); 
Intervalo <- paste0("mu ∈  ","(",round(mu1,2),",",round(mu2,2),")"); 
print(Intervalo)
```

Sesión 12

Varianzas conocidas e iguales

```{r } 
DesvEst <- 0.8
n1 <- 50
n2 <- 50
xbarra1 <- 3.5
xbarra2 <- 4.2
xbarra <- xbarra1-xbarra2
alpha <- 90; Zalpha1 <- 1.64
alpha <- 95; Zalpha2 <- 1.96
alpha <- 99; Zalpha3 <- 2.57

nc <- Zalpha2
ErrorStd <- DesvEst*sqrt((n1+n2)/(n1*n2))
ErrorStd <- DesvEst*sqrt((1/n1)+(1/n2))

LimInf <- xbarra - nc*ErrorStd; print(LimInf)
LimSup <- xbarra + nc*ErrorStd; print(LimSup)

Intervalo <- paste0("mu ∈  ","(",round(LimInf,2),",",
                    round(LimSup,2),")"); 
print(Intervalo)
```

Varianzas desconocidas e iguales

```{r } 
n1 <- 10
n2 <- 12
xbarra1 <- 6.5
xbarra2 <- 5.8
S1 <- 0.7
S2 <- 0.9
xbarra <- xbarra1-xbarra2
nc <- 0.975
Sd <- sqrt(((n1-1)*S1^2+(n2-1)*S2^2)/(n1+n2-2))
gl = n1+n2-2
Talpha2 <- round(qt(nc, gl),4)
LimInf <- xbarra - Talpha2*(Sd); 
LimSup <- xbarra + Talpha2*(Sd); 
Intervalo <- paste0("mu ∈  ","(",
                    round(LimInf,2),
                    ",",
                    round(LimSup,2),
                    ")"); 
print(Intervalo)
```

Varianzas desconocidas y distintas

Se quiere comparar la efectividad de dos medicamentos para el dolor de cabeza. 
Se toma una muestra de 10 pacientes para el medicamento A y otra muestra de 12 pacientes para el medicamento B. Los resultados muestran que la media del medicamento A es de 6.5 y la media del medicamento B es de 5.8. 
Las desviaciones estándar son de 0.7 para el medicamento A y 0.9 para el medicamento B. 
Construya un intervalo de confianza del 95% para la diferencia de medias.

```{r }
n1 <- 10
n2 <- 12
xbarra1 <- 6.5
xbarra2 <- 5.8
S1 <- 0.7
S2 <- 0.9
xbarra <- xbarra1-xbarra2
nc <- 0.975
Sd <- sqrt(((S1^2)/n1)+((S2^2)/n2))

numerador <- (((S1^2)/n1)+((S2^2)/n2))^2
denominador <- ((((S1^2)/n1)^2)/(n1-1))+((((S2^2)/n2)^2)/(n2-1))
gl = ceiling(numerador/denominador)
Talpha2 <- round(qt(nc, gl),4)

LimInf <- xbarra - Talpha2*(Sd); 
LimSup <- xbarra + Talpha2*(Sd); 
Intervalo <- paste0("mu ∈  ","(",
                    round(LimInf,2),
                    ",",
                    round(LimSup,2),
                    ")"); 
print(Intervalo)
```